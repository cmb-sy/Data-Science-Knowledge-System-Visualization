{
  "mcpServers": {
    "storybook-mcp": {
      "type": "http",
      "url": "http://127.0.0.1:6006/mcp"
    },
    "next-devtools": {
      "command": "npx",
      "args": ["-y", "next-devtools-mcp@latest"]
    },
    "math-formula-renderer": {
      "command": "node",
      "args": [
        "-e",
        "const katex = require('katex'); const readline = require('readline'); const rl = readline.createInterface({ input: process.stdin, output: process.stdout }); rl.on('line', (line) => { try { const { formula, displayMode } = JSON.parse(line); const html = katex.renderToString(formula, { displayMode: displayMode !== false, throwOnError: false, trust: true }); console.log(JSON.stringify({ success: true, html })); } catch (e) { console.log(JSON.stringify({ success: false, error: e.message })); } });"
      ],
      "env": {
        "NODE_PATH": "./frontend/node_modules"
      },
      "description": "数式レンダリング用MCPサーバー（KaTeXを使用）"
    },
    "python-distribution-calculator": {
      "command": "python3",
      "args": [
        "-c",
        "import sys, json; from backend.models.distributions import get_distribution_info, calculate_distribution; data = json.load(sys.stdin); dist_type = data.get('type'); params = data.get('parameters', {}); result = calculate_distribution(dist_type, params); print(json.dumps({'success': True, 'data': result.model_dump(), 'info': get_distribution_info(dist_type).model_dump()}))"
      ],
      "env": {
        "PYTHONPATH": "./backend"
      },
      "description": "確率分布計算用MCPサーバー（Python + NumPy/SciPy）"
    },
    "latex-formula-generator": {
      "command": "python3",
      "args": [
        "-c",
        "import sys, json; from sympy import symbols, latex, exp, Piecewise, Rational; data = json.load(sys.stdin); formula_type = data.get('type'); params = data.get('parameters', {}); x = symbols('x'); lambda_sym = symbols('lambda'); if formula_type == 'exponential_pdf': formula = Piecewise((lambda_sym * exp(-lambda_sym * x), x >= 0), (0, True)); elif formula_type == 'exponential_cdf': formula = Piecewise((0, x < 0), (1 - exp(-lambda_sym * x), x >= 0)); else: formula = x; print(json.dumps({'success': True, 'latex': latex(formula)}))"
      ],
      "env": {
        "PYTHONPATH": "./backend"
      },
      "description": "LaTeX数式生成用MCPサーバー（SymPyを使用）"
    }
  },
  "tools": {
    "render_formula": {
      "name": "render_formula",
      "description": "LaTeX形式の数式をHTMLにレンダリングします",
      "inputSchema": {
        "type": "object",
        "properties": {
          "formula": {
            "type": "string",
            "description": "LaTeX形式の数式（例: \\frac{1}{b-a}）"
          },
          "displayMode": {
            "type": "boolean",
            "description": "表示モード（true: ブロック表示、false: インライン表示）",
            "default": true
          }
        },
        "required": ["formula"]
      }
    },
    "calculate_distribution": {
      "name": "calculate_distribution",
      "description": "確率分布のデータを計算します",
      "inputSchema": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["uniform", "exponential"],
            "description": "分布の種類"
          },
          "parameters": {
            "type": "object",
            "description": "分布のパラメータ（例: {\"a\": 0, \"b\": 1} または {\"lambda_\": 1.0}）"
          }
        },
        "required": ["type", "parameters"]
      }
    },
    "generate_latex_formula": {
      "name": "generate_latex_formula",
      "description": "確率分布の数式をLaTeX形式で生成します",
      "inputSchema": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "exponential_pdf",
              "exponential_cdf",
              "uniform_pdf",
              "uniform_cdf"
            ],
            "description": "数式の種類"
          },
          "parameters": {
            "type": "object",
            "description": "数式に使用するパラメータ"
          }
        },
        "required": ["type"]
      }
    }
  },
  "resources": {
    "formula_templates": {
      "uri": "file:///formula-templates.json",
      "name": "数式テンプレート",
      "description": "よく使用される確率分布の数式テンプレート"
    },
    "distribution_info": {
      "uri": "file:///backend/models/distributions",
      "name": "分布情報",
      "description": "確率分布の定義と情報"
    }
  },
  "python": {
    "interpreter": "python3",
    "packages": ["numpy", "scipy", "sympy", "fastapi", "pydantic"],
    "path": "./backend"
  },
  "nextjs": {
    "framework": "next",
    "version": "14.0.4",
    "path": "./frontend",
    "dependencies": {
      "katex": "^0.16.9",
      "recharts": "^2.10.3",
      "axios": "^1.6.5"
    },
    "formulaRendering": {
      "library": "katex",
      "displayMode": true,
      "throwOnError": false,
      "trust": true
    }
  }
}
